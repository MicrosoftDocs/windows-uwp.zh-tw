---
title: RTA 的最佳做法
description: 當手寫筆使用 Xbox Live 的即時活動的服務時，深入了解最佳做法。
ms.assetid: 543b78e3-d06b-4969-95db-2cb996a8bbd3
ms.date: 04/04/2017
ms.topic: article
keywords: xbox live、 xbox、 遊戲、 uwp、 windows 10，其中一個 xbox、 即時活動
ms.localizationpriority: medium
ms.openlocfilehash: 7733aab9330c316ad5938cf9a2ef763e06f19b9a
ms.sourcegitcommit: b034650b684a767274d5d88746faeea373c8e34f
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/06/2019
ms.locfileid: "57613563"
---
# <a name="real-time-activity-rta-best-practices"></a>即時活動 (RTA) 的最佳作法
這些最佳作法將協助您充分利用您的標題使用的 RTA。


## <a name="the-basics"></a>基本概念

RTA 會同時使用 WebSocket 工作階段，在使用用戶端建立持續連線。 這就是如何服務時，將為您提供的統計資料。 用戶端必須將已驗證的連接要求，傳送 RTA 用在要求上提供的權杖來確認連線可以進行，然後再建立它，

一旦建立連線，您的應用程式可以訂閱特定統計資料的要求。 成功的訂用帳戶，RTA 會傳回目前的值，以及其他的中繼資料，例如統計資料，做為回應承載一部分的型別。 然後，RTA 會轉送用戶端訂閱時，會發生與統計資料的任何更新。

當您的標題並不需要即時統計資料更新時，它應該終止之統計資料至其訂用帳戶。


## <a name="handling-disconnects"></a>處理中斷連線

項目應該要注意，當使用者的驗證權杖到期時，他們的工作階段將會終止服務。 標題必須能夠偵測這類事件發生時，重新連線，然後重新訂閱它先前已訂閱的所有統計資料。

兩個小時後會關閉 RTA 連線，根據設計，會強制用戶端重新連線。 這是因為連線的驗證權杖會快取來儲存訊息頻寬。 最後該權杖會過期。 關閉連接並強制用戶端重新連線用戶端會強制重新整理驗證權杖。

用戶端可能也取得中斷連線，因為使用者的 ISP 遇到任何問題，或是標題的程序被擱置時。 當發生這種情況時，WebSocket 事件會引發，讓用戶端了解。 一般情況下，建議您最好能夠處理的作法中斷服務。

> [!WARNING]
> 如果用戶端使用 RTA，多人連線的工作階段，並為 30 秒，中斷連線[多人連線的工作階段 Directory(MPSD)](../multiplayer/multiplayer-appendix/multiplayer-session-directory.md)偵測到 RTA 工作階段已關閉，且一開始會將使用者登出工作階段。 它由 RTA 用戶端偵測關閉連線時，起始重新連線並重新訂閱 MPSD 結束工作階段之前。

## <a name="managing-subscriptions"></a>管理訂用帳戶

相對於管理訂用帳戶，當權杖到期時，您的標題應該完全追蹤時間的訂用帳戶已有。 在成功訂閱，RTA 會傳回每個訂閱的統計資料的唯一識別碼。 在所有未來的更新之統計資料，識別項會使用而不是統計資料的名稱。 這是為了節省頻寬。 用戶端會負責維護自己的 RTA 訂用帳戶識別碼的統計資料的對應。


## <a name="unsubscribing"></a>取消訂閱

具有未使用的訂用帳戶不建議使用。 服務會限制使用者在每個有標題在指定時間的訂用帳戶數目。 如果您訂閱的所有項目和任何項目，您可能會達到該限制，以及這可能會導致一些重要的統計資料的訂用帳戶。 (如需有關訂用帳戶限制的詳細資訊，請參閱 <<c0>  **節流**，本主題稍後的。)

比方說，您的標題可能只需要加入某些場景的訂用帳戶。 當使用者輸入場景時，應該訂閱您的標題。 當使用者離開該場景時，應該取消訂閱這些統計資料。 同樣地，是可以用於任何訂用帳戶所需的取消訂閱所有訊息。

之後取消訂閱，將不再使用之統計資料的訂用帳戶識別碼。


## <a name="awareness-of-latent-items-in-the-queue"></a>潛在的項目在佇列中的情況下

取消訂閱統計資料，時，可能還在觸達您的用戶端統計資料更新。 因此，即使您的標題就已取消訂閱統計資料，要注意，它可能仍然會取得更新，或兩個相關之統計資料。

建議是要略過的統計資料更新時無法辨識的訂用帳戶識別碼。


## <a name="ignore-messages-you-do-not-understand"></a>忽略不了解的訊息

可以，取得更新的訊息通訊協定。 若要保留您的應用程式無從驗證的任何新訊息，建議您標題只是捨棄無法辨識的訊息類型。


## <a name="throttles"></a>節流

RTA 會強制執行特定服務上的節流：

-   UserStats:1000
-   目前狀態：2500

若用戶端節流限制可能會取消訂閱/訂閱的呼叫，過程中收到錯誤，或將會中斷。 在任一情況下，將可供用戶端及錯誤訊息已點擊的節流限制的詳細資訊，或將其中斷連線訊息中。

在開發您的標題，請注意這些概念。 如果您要執行極大的項目，您可能必須降低的應用程式體驗，因為服務無法節流的呼叫。 權限的服務現在允許 1000年訂用帳戶每個執行個體的應用程式的統計資料。 所，應用程式的執行個體也可以訂閱的目前狀態更新使用者的整個的人員清單的長度。 正在微調此數字，因此它可能在未來版本中變更。
