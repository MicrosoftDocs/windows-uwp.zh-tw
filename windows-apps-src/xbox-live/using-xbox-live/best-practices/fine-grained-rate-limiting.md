---
title: Xbox Live 沒問題的更細緻的速率限制
description: 了解如何 Xbox Live 更細緻的速率限制的運作方式，以及如何避免您的標題，防止速率限制。
ms.assetid: ceca4784-9fe3-47c2-94c3-eb582ddf47d6
ms.date: 04/04/2017
ms.topic: article
keywords: xbox live、 xbox、 遊戲、 uwp、 windows 10、 xbox，節流、 比率限制
ms.localizationpriority: medium
ms.openlocfilehash: b79a4f0a873ffaf5dd824a0c9832f61aa4a7d77f
ms.sourcegitcommit: b034650b684a767274d5d88746faeea373c8e34f
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/06/2019
ms.locfileid: "57628683"
---
# <a name="xbox-live-fine-grained-rate-limiting"></a>Xbox Live 沒問題的更細緻的速率限制

## <a name="introduction"></a>簡介

這篇文章概述的 Xbox Live 沒問題的更細緻的速率限制。 除了彙總何種速率限制是，這份白皮書還打算幫助您判斷您都會受到限制，而且如果，哪些工具和資源可供您使用。

## <a name="terminology-guide"></a>術語指南

| 詞彙         | 定義                                                  |
|--------------|-----------------------------------------------------------------------------
| FGRL         | 細緻速率限制                                                  
| XSAPI        | Xbox 服務應用程式開發介面                                 
| CU           | 內容更新                                                              
| 高載        | 表示在短時間內收到的要求數量          
| 承受      | 代表大量持續一段時間所收到的呼叫
| 使用者 + 標題 | 代表使用者和視作一個實體的標題的配對                    
| XLTA         | Xbox Live 追蹤 Analyzer 工具，用於判斷是否正在速率限制您的標題。

## <a name="xbox-live-fine-grained-rate-limiting"></a>Xbox Live 沒問題更細緻的速率限制

**精確精細的速率限制**已升級委任**公平使用**Xbox Live 的共用資源，在不同的項目之間。 此解決方案就像大部分的傳統限制的系統具有保留的實體所做的一段指定時間的要求數目的服務。

連線到服務的指定的限制的實體再移到其中所有的連入要求，從實體將會開啟立即拒絕狀態。 實體是時間的只能夠在特定的期間過期造成的實體相關聯的 「 計數重設時，請結束此狀態。

沒問題精細速率限制會使用相同的核心技術上述不過而不是追蹤某個實體 FGRL 追蹤的組合**使用者和標題**，然後比較相關聯的計數，以**兩個**不同**限制**如對抗其中一個。 FGRL 雙重限制會強制執行每個服務，這表示 GameClips 的要求計數不會影響目前狀態的要求計數。 下列各節將會進入更多詳細的使用者和標題配對、 雙重的限制，以及 HTTP 429 限制回應物件。

## <a name="fair-usage"></a>使用公平無虞

Xbox Live 認為每位使用者，應該有相同的高品質體驗不論他/她玩哪些遊戲/應用程式。 FGRL 是設計用來解決下列案例：

開發人員的剛發行的標題，會遵循所有 Xbox 開發人員 B 也剛剛發行的 「 標題時，確保最佳使用服務的最佳作法不過這個有未知的錯誤。 這個 bug 會導致在標題和垃圾郵件會導致將負載過重的服務存在的每位使用者。 服務會變慢，而且最後會暫止中斷的開發人員 A 的使用者體驗，即使它是造成此問題的開發人員 B 的 bug。 如果用來實作 FGRL 服務已經能夠停止接收行為讓它的標題遺失，提供開發人員 A 的標題及其公平圓形圖的配量資源的要求。

## <a name="title-and-user-granularity"></a>標題和使用者的資料粒度

標題和使用者所做為索引鍵選擇，以確保公平的 Xbox Live 的資源使用量。 追蹤使用者只會建立所在的使用者經驗會是每個項目整合的掌控的案例。 比方說，大部分的項目使用人服務已因此基於此範例，假設正常精細速率限制在 5 分鐘內讓不超過 100 個要求的人服務上設定。 如果使用者来玩遊戲時，在 1 分鐘內進行 100 個要求會超過此限制，而且使用者會無法任何更多服務提出要求的人;想像一下，在相同的期間內使用者再回到主畫面，並按一下他的朋友清單：因為使用者會已超出限制的朋友清單呼叫會失敗，直到超過間隔，在 5 分鐘即使主畫面是不負責將使用者放在有限的狀態。

或者限制僅根據標題會產生同樣不公平的結果。 設定每個標題的限制，則會忽略標題的熱門程度，並要求會第一次移到先拿直到達到的限制。

使用者和標題的配對，可確保沒有標題，會使用比適當指定作用中使用者的數目，同時也為每個使用者提供一致的資源圓形圖配量的更多資源。

![](../../images/FGRL.png)

上圖顯示如何處理要求的高層級檢視。 第一次要求時產生，而且再收到所需的服務。 在收到要求時，系統會檢查使用者和放在一起的標題已存取服務的次數。 如果要求在限制之內為止，然後它會處理正常。 如果要求是達到或超過限制的服務會卸除它，並改為傳回 429 的回應。 回應會指出多久之前期間的彙透過和可處理使用者和標題的要求。

## <a name="burst-and-sustain-limits"></a>高載及維持絕佳的限制

傳統上，速率限制包含每個端點，這會追蹤一段指定時間的一項限制。 這段期間代表的時間量會追蹤實體的要求計數。 結尾的句點實體計數重設為 0，以開始追蹤一次。

這個方法適用於大部分的 API 可讓您的不過它不是有足夠的彈性，遊戲和應用程式呼叫 Xbox live。 上述的解決方案假設人會呼叫在一致的穩定可預期 manor。 在 Xbox Live 的情況下，「 服務 」 和 「 要求標題/應用程式，根據呼叫的模式是大相逕庭。

選擇只是一項限制在此情況下需要犧牲兩端的呼叫模式範圍。 Xbox Live 解決方案使用兩個句點和限制。 雖然 Sustain 期間就不再是一大是較小的期間稱為高載期間。 高載時間週期的 FGRL 一律為 15 秒而 sustain 一律為 300 秒 （5 分鐘） 因此在 5 分鐘 sustain 的期間內，有 20 高載期間。 同時尖峰和維持絕佳的限制會追蹤在相同的時間，因此計數要求在相同的時間。 這表示每個服務都有它自己的高載和 sustain 計數的服務上設定暴增和 sustain 限制。 一起協助您了解這些兩個限制的運作方式下表顯示播放曲目便提出要求的服務，已實作 FGRL 數量的使用者。 在此情況下的高載限制為 15 秒 30 個要求，而 sustain 限制是 100 個要求超過 5 分鐘。

| 時間週期 （秒）  | 每個高載期間的要求  | 每個要求承受期間  | \# 15 秒的間隔內的節流要求 | 哪些限制？ (高載，維持，或兩者)  |
|-------------|--------------|----------------|-----------------------------------------------------|---------------------------|
| 0-15        | 35           | 35             | 5                                                   | 高載                     |
| 15-30       | 28           | 63             | 0                                                   | 無                       |
| 30-45       | 21           | 84             | 0                                                   | 無                       |
| 45-60       | 36           | 120            | 20                                                  | 兩者                      |
| 60-75       | 24           | 144            | 24                                                  | 承受                   |
| …           | …            | …              |                                                     | …                         |
| 285-300     | 4            | 148            |                                                     | 承受                   |

下表顯示，在前 15 秒的使用者車程暴增限制提出 35 的要求。 這些額外的 5 個要求都會被卸除，而且 5 429 傳送回應。 值得注意的是，這些 5 個要求透過節流仍然計入 sustain 限制。 一旦錯誤可能是限制任何要求會不讓，同時限制在 45 的第二個標記的車程，且一次當只有 4 個要求 285 第二個標記時所示。

## <a name="http-429-response-object"></a>HTTP 429 回應物件

相關聯的使用者和標題計數已達到或超過其中一個暴增或承受限制時服務不會處理要求，並會改為傳回 HTTP 429 回應。 「 太多要求 」 HTTP 429 的程式碼代表將會伴隨包含 「 X 秒重試後的 」 值的標頭。 FGRL 429 會包含標頭所指定的時間呼叫的實體應該等待然後重試之後重試。 使用 XSAPI 的開發人員不必擔心，因為 XSAPI 會接受並處理 Retry-after 標頭。 實際的回應會包含下列欄位：

| 欄位名稱      | 值類型 | 範例                | 定義                       |
|-----------------|------------|------------------------|----------------------------------|
| 版本         | 整數    | `"version":1`          |                                  |
| currentRequests | 整數    | `"currentRequests":13` | 傳送的要求總數    |
| maxRequests     | 整數    | `"maxRequests":10`     | 允許的要求總數 |
| periodInSeconds | 整數    | `“periodInSeconds”:15` | 時間範圍                      |
| 類型            | 字串     | `“type”:”burst”`       | 節流限制型別              |

## <a name="implemented-limits"></a>實作的限制

下列服務已實作 FGRL 限制，以強制執行這些限制，因為就地**2016 年**。 再次提醒您，這些限制都是一樣的所有沙箱和標題。 **已透過 Xbox 開發人員平台或合作夥伴中心所發行且隨附在 2016 年之前的任何標題會被視為舊版，並因此豁免。**

| **名稱** | **高載限制**（每位使用者標題每 15 秒） | **承受限制**（每位使用者每標題的 300 秒） | **憑證限制**(10 x Sustained，每位使用者每標題的 300 秒) |
|----------------------------|---------------------------|----------------------------|----------------------------|
| 統計資料讀取                 | 100                       | 300                        | 3000                       |
| 設定檔                    | 10                        | 30                         | 300                        |
| MPSD                       | 30                        | 300                        | 3000                       |
| 顯示線上狀態                   | 讀取 10，寫入 3          | 讀取 100，寫入 30         | 讀取的 1000，撰寫 300       |
| 社交活動                     | 10                        | 30                         | 300                        |
| 排行榜               | 30                        | 100                        | 1000                       |
| 成就               | 100                       | 300                        | 3000                       |
| 智慧比對                | 10                        | 100                        | 1000                       |
| 使用者貼文                 | 100                       | 300                        | 3000                       |
| 統計資料寫入                | 100                       | 300                        | 3000                       |
| 隱私權                    | 10                        | 30                         | 300                        |
| 社團                      | 10                        | 30                         | 300                        |

上表表示目前的 FGRL 針對所選取的服務清單。 這份清單不是最終為新的服務，可以加入現有的服務。 服務時要加入的資料表將會更新，並將進行公告。 表示資料表中的限制應該也不視為完成。 因為服務變更和改進，也會限制，不過，您會收到通知，並將進行必要的舊版豁免。

至於**2018 年 4 月**標題將無法通過認證，如果超過 sustain 限制 10 倍 （以的速率限制會生效的限制）。  比方說，如果在上表中所指定的 300 秒，持續的 FGRL 才會生效的限制設為 300 的呼叫，標題等於或高於 3000 在 300 秒的呼叫會導致認證失敗。 

## <a name="service-mapping-and-title-effects-of-rate-limiting"></a>服務對應 」 和 「 Title 效果速率限制

| **名稱** | **服務端點** | **Anticipiated 遊戲的 FGRL 的影響**
| --- | :---: | --- 
| 統計資料讀取 | userstats.xboxlive.com | 成就或排行榜的項目不會更新，或擷取。
| 設定檔 | profile.xboxlive.com | 播放程式的資料不會更新，或正確顯示。
| MPSD | sessiondirectory.xboxlive.com | 聯結/邀請會不正確地完成，工作階段尚未建立，或它可能會導致標題失敗正確更新。
| 顯示線上狀態 | presence.xboxlive.com | 玩家的遊戲中的目前狀態不會精確。
| 社交活動 | social.xboxlive.com | 會影響所有朋友寫入 （例如新增朋友，讓人最愛的等等），可能會影響 friend 讀取 （例如擷取我的朋友清單）。 開發人員都可讀取，而不是 social.xboxlive.com peoplehub。
| 排行榜 | leaderboards.xboxlive.com | 在遊戲排行榜的 UX 會無法填入/更新。
| 成就 | achievements.xboxlive.com | 解除鎖定的成就的遊戲中 UX 不會更新。
| 智慧比對 | momatch.xboxlive.com | 相符項目就不會成功地設定。
| 使用者貼文 | userposts.xboxlive.com | 不會出現使用者貼文。
| 統計資料寫入 | statswrite.xboxlive.com | 成就或排行榜項目不會更新。
| 隱私權 | privacy.xboxlive.com | 隱私權失敗可能導致封鎖存取，所有呼叫端。
| 社團 | Clubhub.xboxlive.com | 播放程式可能無法看到他們在遊戲俱樂部。

**注意：** 最新的 API 對應會定期更新，且可以下找到[即時追蹤分析器 API 對應](https://github.com/Microsoft/xbox-live-trace-analyzer/blob/master/Source/XboxLiveTraceAnalyzer.APIMap.csv)。

## <a name="faq"></a>常見問題集

## <a name="how-can-i-determine-i-am-being-throttled-and-what-steps-can-i-take"></a>如何得知我正在進行節流處理和可採取哪些步驟？

請參閱[Xbox Live 的最佳作法](best-practices-for-calling-xbox-live.md)文件，因為它會包含為改善呼叫模式，以及如何通知您的使用 XSAPI 判斷提示和 XSAPI 社交和多人管理員說明的步驟和降低節流的問題。

另一個選項是記錄的 Xbox Live 的呼叫追蹤和分析 [追蹤使用[Xbox Live 追蹤分析師] 工具](https://docs.microsoft.com/windows/uwp/xbox-live/tools/analyze-service-calls)。  若要錄製追蹤，您可以使用 Fiddler 以記錄。SAZ 檔案或使用 XSAPI 的內建的追蹤記錄。 如需詳細資訊，若要使用 XSAPI 中追蹤開啟請參閱的 Xbox Live 文件頁面 「 Xbox Live 服務的分析呼叫 」 的方式。 追蹤之後，Xbox Live 追蹤分析工具就會發出警告時偵測節流處理的呼叫。

紙張上 GDNP 和 SDK 和 XDK 的文件 1602年和更新版本，您可以找到的最佳作法。

### <a name="can-limits-change"></a>限制可以變更嗎？

其用意是發佈的限制不會隨著時間變更。 不過，如果需要引起了很多，就可能一些限制可能進行更嚴格，在此情況下，您會為零售版已經發行的項目做為免套用的更新的限制。

### <a name="are-more-services-going-to-get-limits"></a>更多服務會取得限制？

是，更多的服務和新的服務可能，也會建立限制。 不過只要像第一 FGRL 版將會通知您，並會採取適當的預防措施。

### <a name="when-will-these-changes-take-effect"></a>何時這些變更才會生效？

因為強制執行速率限制**2016 年**。  至於**2018 年 4 月**、 超過指定的項目持續限制 10 倍或更多將無法通過 Xbox 認證程序。

### <a name="what-if-we-cant-adhere-to-the-limits"></a>如果我們無法遵守限制？

請參閱[Xbox Live 的最佳作法](best-practices-for-calling-xbox-live.md)，並確定您遵循這些步驟。  也請考慮使用[社交 manager](../../social-platform/intro-to-social-manager.md)如果您正在受到速率限制與任何社會服務。

如果這些步驟後，您仍然無法保持在限制，請連絡到您開發人員帳戶管理員 」 中。

**附註：等於或高於 10 倍的指定的 sustain 限制的項目將不允許將自 2018 年 4 月起生效的憑證**。  比方說，如果在上表中所指定的 300 秒，持續的 FGRL 才會生效的限制設為 300 的呼叫，標題等於或高於 3000 在 300 秒的呼叫會導致認證失敗。

### <a name="what-about-my-existing-title"></a>我現有的標題呢？

在 2018 年 4 月之前的零售版中的任何項目會被視為舊版，而且不受限制。

### <a name="content-updates"></a>內容更新嗎？

舊版或免套用的標題，內容也會更新豁免，但我們強烈建議您運用的工具和以最佳化您的遊戲中的服務整合層面的資產。

### <a name="can-i-get-an-exemption-for-my-game-until-i-can-make-a-content-update"></a>可以取得豁免我的遊戲直到我可以讓內容的更新？

請說出與您開發人員的帳戶管理員。
