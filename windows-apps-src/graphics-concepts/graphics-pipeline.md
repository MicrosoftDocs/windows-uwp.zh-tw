---
title: 圖形管線
description: Direct3D 圖形管線專為即時遊戲應用程式產生圖形而設計。 透過每個可設定或可編程階段，從輸入到輸出的資料流。
ms.assetid: C9519AD0-5425-48BD-9FF4-AED8959CA4AD
keywords:
- 圖形管線
- 管線階段
author: michaelfromredmond
ms.author: mithom
ms.date: 02/08/2017
ms.topic: article
ms.localizationpriority: medium
ms.openlocfilehash: d4a362a3a7be06e48c64ce3e4d43ff917b9b24c5
ms.sourcegitcommit: e814a13978f33654d8e995584f4b047cb53e0aef
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/05/2018
ms.locfileid: "6040133"
---
# <a name="graphics-pipeline"></a>圖形管線


Direct3D 圖形管線專為即時遊戲應用程式產生圖形而設計。 透過每個可設定或可編程階段，從輸入到輸出的資料流。

所有階段都可以使用 Direct3D API 設定。 搭配常見著色器核心的階段 (圓角矩形區塊) 可使用 [HLSL](https://msdn.microsoft.com/library/windows/desktop/bb509561) 程式語言進行程式設計。 如此可讓管線極具彈性和適應能力。

最常使用的是頂點著色器 (VS) 階段和像素著色器 (PS) 階段。 如果您連這些著色器階段都未提供，則會使用預設的沒有選項、傳遞頂點和像素著色器。

![Direct3D 11 可程式化管線中的資料流程圖](images/d3d11-pipeline-stages.jpg)

## <a name="input-assembler-stage"></a>輸入組合語言階段

|-|-| |用途 |[輸入組合語言 (IA) 階段](input-assembler-stage--ia-.md)提供基本類型和相鄰資料至管線，例如三角形、 行及點，包括語意識別碼，來協助讓著色更有效率藉由減少處理尚未已經過的基本類型處理。 ||輸入 |（三角形、 線條和/或點），從記憶體中使用者填入緩衝區的基本類型資料。 以及可能相鄰的資料。 三角形會是每個三角形的 3 個頂點，並可能是 3 個頂點，每個三角形的相鄰資料。 ||輸出 |基本類型含有附加系統產生值 （例如基本類型識別碼、 執行個體識別碼或頂點識別碼）。 |

## <a name="vertex-shader-stage"></a>頂點著色器階段

|-|-| |用途 |[頂點著色器 (VS) 階段](vertex-shader-stage--vs-.md)處理頂點，通常執行作業，例如轉換、 皮膚形變與光照。 頂點著色器採用單一輸入頂點，並產生單一輸出頂點。 個別的每個頂點作業，例如轉換、 貼圖、 變形及每個頂點光源。 ||輸入 |單一頂點，有 VertexID 和 InstanceID 系統產生的值。 每個頂點著色器輸入的頂點可包含的最多 16 個 32 位元向量 （每個最多 4 個元件）。 ||輸出 |單一頂點。 每個輸出頂點可包含的多達 16 個 32 位元 4 元件向量。 |
 
## <a name="hull-shader-stage"></a>輪廓著色器階段
 
|-|-| |用途 |[輪廓著色器 (HS) 階段](hull-shader-stage--hs-.md)是其中一個鑲嵌階段，有效率地將模型的單一表面分成多個三角形。 輪廓著色器會針對每個塊面叫用一次，並且將定義低位表面的輸入控制點轉換成構成塊面的控制點。 它也會進行一些每個塊面計算，以提供資料給曲面細分器 (TS) 階段和網域著色器 (DS) 階段。 ||輸入 |介於 1 到 32 輸入的控制點，共同定義低位表面。 ||輸出 |1 到 32 輸出控制點之間，共同構成塊面。 輪廓著色器宣告曲面細分器 (TS) 階段，包括控制點、 塊面，類型，以及鑲嵌時分割使用的類型的數目的狀態。 |

## <a name="tessellator-stage"></a>曲面細分器階段

|-|-| |用途 |[曲面細分器 (TS) 階段](tessellator-stage--ts-.md)建立代表幾何塊面，並產生一組連接這些樣本的小物件 （三角形、 點或線） 的網域取樣模式。 ||輸入 |曲面細分器會執行一次針對每個塊面使用鑲嵌係數 （這會指定網域將鑲嵌如何精確） 和分割的類型 （這會指定用來補充程式切片的演算法） 中傳遞從輪廓著色器階段。 | |輸出 |曲面細分器輸出 uv （和選擇性 w） 座標及表面拓撲至網域著色器階段。 |

## <a name="domain-shader-stage"></a>網域著色器階段

|-|-| |用途 |[網域著色器 (DS) 階段](domain-shader-stage--ds-.md)會計算輸出塊面; 中細分點的頂點位置它會計算對應每一個網域取樣的頂點位置。 網域著色器會執行每個曲面細分器階段輸出點和具有唯讀存取輪廓著色器輸出塊面和輸出塊面常數，以及曲面細分器階段輸出 UV 座標一旦。 ||輸入 |網域著色器會耗用來自[輪廓著色器 (HS) 階段](hull-shader-stage--hs-.md)輸出控制點。 輪廓著色器輸出包括：控制點、塊面常數資料及鑲嵌係數 (鑲嵌係數可能包括固定函式曲面細分器使用的值，以及整數鑲嵌進位之前的原始值，可簡化地理變形)。 每個輸出座標從[曲面細分器 (TS) 階段](tessellator-stage--ts-.md)的 「 網域著色器就會叫用一次。 ||輸出 |網域著色器 (DS) 階段輸出輸出塊面中細分點的頂點位置。 |

## <a name="geometry-shader-stage"></a>幾何著色器階段

|-|-| |用途 |[幾何著色器 (GS) 階段](geometry-shader-stage--gs-.md)會處理整個基本類型： 三角形、 線條和點，以及它們相鄰的頂點。 它支援幾何放大和取消放大。 它對於演算法來說很實用，包括 Point Sprite Expansion、Dynamic Particle Systems、Fur/Fin Generation、Shadow Volume Generation、Single Pass Render-to-Cubemap、Per-Primitive Material Swapping 及 Per-Primitive Material Setup (包括產生質心座標做為基本類型資料，如此像素著色器就能執行自訂屬性插補)。 | |輸入 |不同於頂點著色器，在單一頂點操作，幾何著色器的輸入是完整基本類型 （三角形的三個頂點、 線條的兩個頂點或點的單一頂點） 的頂點。 ||輸出 |幾何著色器 (GS) 階段是能夠輸出多個頂點，以形成選取的單一拓撲。 可用的幾何著色器輸出拓撲包括 <strong>tristrip</strong>、<strong>linestrip</strong> 和 <strong>pointlist</strong>。 發出的基本類型數目可在幾何著色器的任何叫用內自由改變，雖然可發出的頂點最大數目必須以靜態方式宣告。 從幾何著色器叫用發出連環長度都可以任意，並且可透過[RestartStrip](https://msdn.microsoft.com/library/windows/desktop/bb509660) HLSL 函式來建立新的連環。 |

## <a name="stream-output-stage"></a>資料流輸出階段

|-|-| |用途 |[資料流輸出 (SO) 階段](stream-output-stage--so-.md)會持續輸出 （或串流） 到記憶體中的一或多個緩衝區的頂點資料從上一個作用中階段。 串流輸出到記憶體的資料可以循環回管線做為輸入的資料或從 CPU 讀回。 ||輸入 |頂點資料從上一個管線階段。 ||輸出 |資料流輸出 (SO) 階段會持續輸出 （或串流） 到記憶體中的一或多個緩衝區的頂點資料從上一個作用中階段，例如幾何著色器 (GS) 階段。 如果幾何著色器 (GS) 階段為非使用中，而資料流輸出 (SO) 階段為使用中，它會持續將頂點資料從網域著色器 (DS) 階段到記憶體 （或者，如果 DS 也是非使用中，從頂點著色器 (VS) 階段） 中的緩衝區。 |

## <a name="rasterizer-stage"></a>點陣化階段

|-|-| |用途 |[轉譯器 (RS) 階段](rasterizer-stage--rs-.md)裁剪的基本類型不在檢視中，為像素著色器 (PS) 階段，準備基本類型，以及決定如何叫用像素著色器。 轉換向量資訊 （由圖形或基本類型組成） 為點陣影像 （由像素組成），以顯示即時 3D 圖形。 ||輸入 |頂點 （x，y，z，w） 即將進入點陣化階段會假設為在同質的剪輯空間。 在這個座標空間，X 軸指向右，Y 指向和 Z 指向相機離。 ||輸出 |需要經過轉譯的實際像素。 包括一些頂點屬性，用於像素著色器插補。 |

## <a name="pixel-shader-stage"></a>像素著色器階段
 
|-|-| |用途 |[像素著色器 (PS) 階段](pixel-shader-stage--ps-.md)會接收基本類型的插補的資料，並產生每一像素資料，如色彩。 ||輸入 |當管線設定後沒有幾何著色器時，像素著色器會受限於 16、 32 位元、 4 個元件的輸入。 否則，像素著色器最多可以採用 32、32 位元、4 個元件的輸入。 像素著色器輸入資料包括頂點屬性 (可插補，無論是否有透視修正)，也可以視為每個基本類型常數。 像素著色器輸入會從點陣化的基本類型的頂點屬性插補，根據宣告的插補模式。 如果在點陣化之前基本類型被裁剪，則插補模式也會在裁剪過程中採用。 | |輸出 |像素著色器可以輸出最多 8、 32 位元、 4 個元件色彩或無色彩如果捨棄像素。 像素著色器輸出暫存器元件必須先宣告，才能使用;每個暫存有不同的輸出寫入遮罩。 |

## <a name="output-merger-stage"></a>輸出合併階段
 
|-|-| |用途 |[輸出合併 (OM) 階段](output-merger-stage--om-.md)會結合不同類型的輸出資料 （像素著色器值、 深度與樣板資訊） 與轉譯目標和深度/樣板緩衝區，以產生最終的管線結果的內容。 ||輸入 |輸出合併輸入是管線狀態、 像素著色器、 內容的轉譯目標和深度/樣板緩衝區的內容所產生的像素資料。 ||輸出 |最後轉譯的像素色彩。 |

## <a name="related-topics"></a>相關主題

- [Direct3D 圖形學習指南](index.md)

- [計算管線](compute-pipeline.md)
